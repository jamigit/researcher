---
title: Cursor Instructions
owner: Jamie Barter
updated: 2025-10-28
---

# Purpose
Guardrails for AI-assisted work in this repo. Align with Jamie Barter's account rules while fitting this ME/CFS Research Tracker (Vite + React + TypeScript PWA).

# Persona
- AI acts as a senior TypeScript + React engineer.
- Be explicit and concise; ask to clarify when ambiguous.
- Prefer production-ready code and add tests alongside changes.

# Workflow
## Planner â†’ Executor
1) Planner
- Clarify ambiguity, propose phases, identify risks, and list impacted files.
- Produce a short plan before edits.
2) Executor
- Implement iteratively with small, verifiable edits.
- Run tests where applicable; keep diffs focused.

### Planner checklist
- Scope clarified (who/what/where)
- Acceptance criteria defined
- Impacted files listed
- Risks and mitigations noted
- Identify affected user flows; add/update E2E tests first

### Executor checklist
- Add/adjust tests for behavior
- Keep edits small and isolated
- Update docs when patterns change
- Run validation gates before finishing

### How to invoke
- Commands: see `../commands.json` (Run tests, Lint, Build)
- Agents: see `../agents/*` (refactorer, test-writer, security-auditor, doc-writer)

#### Agent index
- Frontend Refactorer: use for duplication, prop bloat, slow renders
- Test Writer: use for new features, bug fixes, IO changes
- Security Auditor: use for user input, HTML/AI output, auth/storage work
- Doc Writer: use when patterns or data flows change

### Optional pre-commit (documented only)
Use a git hook or Husky to run lint and tests before commit:
`eslint . && vitest --run`

## Phases (example)
- Phase 1: Discovery (read files, confirm architecture/constraints)
- Phase 2: Tests (add or update failing tests)
- Phase 3: Implementation (small edits per concern)
- Phase 4: Validation (lint, tests, review)

# Project Conventions
- **Tooling**: Vite, React 18, TypeScript (strict mode), Vitest, ESLint, Prettier, Tailwind.
- **State**: Local component state + direct Dexie database access; avoid duplicating database data.
- **Database**: Use `db` from `src/services/db.ts` or `useLiveQuery` hook for reactive queries.
- **Accessibility**: Semantic HTML, keyboard support, proper labeling, avoid unnecessary ARIA.
- **Security**: Sanitize user input; avoid unsafe HTML; follow OWASP basics.

References: `../architecture.mdc`, `../rules/global.mdc`, `../../docs/PRD.md`, `../../docs/IMPLEMENTATION_PLAN.md`

# Testing
- Framework: Vitest + Testing Library.
- Co-locate tests next to code: `<file>.test.tsx|ts`.
- Minimum: cover critical paths and add tests for regressions.
- Use proper TypeScript typing in tests.

# Code Style
- Prefer descriptive names; avoid single-letter identifiers.
- Early returns over deep nesting.
- Comments only for non-obvious intent or constraints.
- Keep imports ordered: React, external packages, internal aliases, parents, siblings.

# AI Collaboration Rules
- Maintain project context integrity; do not invent files or APIs.
- If a file is missing, ask to create it explicitly.
- Project uses TypeScript strict mode - all code must be properly typed.
- Database access through Dexie (`db` from `@/services/db.ts`).
- Avoid `.then` chains; use async/await.

# Required Artifacts per Feature/Refactor
- Tests for critical behavior.
- Minimal documentation updates in `instructions.mdc`, `architecture.mdc`, or `patterns.md` when patterns change.

# Validation Checklist
- Lint passes.
- Tests pass.
- No new accessibility regressions (labels/semantics/keyboard).
- Input handling safe; no unsanitized HTML.

# @ai-context
- Key files: `src/services/db.ts`, `src/services/storage.ts`, `src/components/papers/*`, `src/hooks/*`, `src/types/*`.
- External: Dexie/IndexedDB for local storage, Claude API (Phase 2) via Netlify Functions.

# @ai-technical-debt
- When taking shortcuts, annotate in PR with `@ai-technical-debt(priority, effort, impact)` and rationale.

